# å®å¡”é¢æ¿éƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨å®‰è£…äº†å®å¡”é¢æ¿çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²æœ¬é¡¹ç›®ï¼ŒåŒ…æ‹¬ç¯å¢ƒé…ç½®ã€æ•°æ®åº“å¯¼å…¥ã€é¡¹ç›®éƒ¨ç½²ç­‰å®Œæ•´æµç¨‹ã€‚

## ğŸ› ï¸ ç¯å¢ƒè¦æ±‚

### æœåŠ¡å™¨é…ç½®
- **æ“ä½œç³»ç»Ÿ**ï¼šCentOS 7+ / Ubuntu 18+ / Debian 9+
- **å†…å­˜**ï¼šè‡³å°‘ 2GB RAM
- **ç¡¬ç›˜**ï¼šè‡³å°‘ 20GB å¯ç”¨ç©ºé—´
- **å®å¡”é¢æ¿**ï¼š7.7.0 æˆ–æ›´é«˜ç‰ˆæœ¬

### è½¯ä»¶ç¯å¢ƒ
- **Node.js**ï¼š16.x æˆ–æ›´é«˜ç‰ˆæœ¬
- **MySQL**ï¼š5.7 æˆ– 8.0
- **Nginx**ï¼š1.18 æˆ–æ›´é«˜ç‰ˆæœ¬
- **PM2**ï¼šè¿›ç¨‹ç®¡ç†å™¨

## ğŸš€ ä¸€æ¡é¾™éƒ¨ç½²æµç¨‹

### ç¬¬ä¸€æ­¥ï¼šå®å¡”é¢æ¿åŸºç¡€é…ç½®

#### 1.1 å®‰è£…å¿…è¦è½¯ä»¶
åœ¨å®å¡”é¢æ¿ â†’ è½¯ä»¶å•†åº—ä¸­å®‰è£…ï¼š
- âœ… **MySQL 8.0**
- âœ… **Nginx 1.20+**
- âœ… **Node.js ç‰ˆæœ¬ç®¡ç†å™¨**
- âœ… **PM2 ç®¡ç†å™¨**

#### 1.2 é…ç½®Node.jsç¯å¢ƒ
```bash
# åœ¨å®å¡”ç»ˆç«¯ä¸­æ‰§è¡Œ
# å®‰è£…Node.js 18.x
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# éªŒè¯å®‰è£…
node --version
npm --version

# å®‰è£…PM2
npm install -g pm2
```

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæ•°æ®åº“

#### 2.1 åœ¨å®å¡”é¢æ¿åˆ›å»ºæ•°æ®åº“
1. è¿›å…¥ **æ•°æ®åº“** â†’ **MySQL**
2. ç‚¹å‡» **æ·»åŠ æ•°æ®åº“**
3. å¡«å†™ä¿¡æ¯ï¼š
   - **æ•°æ®åº“å**ï¼š`author_center`
   - **ç”¨æˆ·å**ï¼š`author_center_user`
   - **å¯†ç **ï¼šç”Ÿæˆå¼ºå¯†ç ï¼ˆè®°å½•ä¸‹æ¥ï¼‰
   - **è®¿é—®æƒé™**ï¼šæœ¬åœ°æœåŠ¡å™¨

#### 2.2 é…ç½®æ•°æ®åº“æƒé™
```sql
-- åœ¨å®å¡”æ•°æ®åº“ç®¡ç†ä¸­æ‰§è¡Œ
GRANT ALL PRIVILEGES ON author_center.* TO 'author_center_user'@'localhost';
FLUSH PRIVILEGES;
```

### ç¬¬ä¸‰æ­¥ï¼šä¸Šä¼ é¡¹ç›®æ–‡ä»¶

#### 3.1 åˆ›å»ºé¡¹ç›®ç›®å½•
åœ¨å®å¡”é¢æ¿ â†’ æ–‡ä»¶ç®¡ç†ä¸­ï¼š
```
/www/wwwroot/vue-manage-system/
â”œâ”€â”€ backend/
â”œâ”€â”€ frontend/
â””â”€â”€ uploads/
```

#### 3.2 ä¸Šä¼ æ–‡ä»¶
å°†ä»¥ä¸‹æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼š
- æ•´ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹
- ç‰¹åˆ«æ³¨æ„ä¸Šä¼  `backend/sql/clean_database_with_admins.sql`

#### 3.3 è®¾ç½®æ–‡ä»¶æƒé™
```bash
# åœ¨å®å¡”ç»ˆç«¯ä¸­æ‰§è¡Œ
cd /www/wwwroot/vue-manage-system
chown -R www:www .
chmod -R 755 .
chmod -R 777 uploads/
```

### ç¬¬å››æ­¥ï¼šå¯¼å…¥æ•°æ®åº“

#### 4.1 æ–¹æ³•ä¸€ï¼šä½¿ç”¨å®å¡”é¢æ¿å¯¼å…¥
1. è¿›å…¥ **æ•°æ®åº“** â†’ ç‚¹å‡»æ•°æ®åº“å â†’ **å¯¼å…¥**
2. é€‰æ‹©ä¸Šä¼  `clean_database_with_admins.sql`
3. ç‚¹å‡»å¯¼å…¥

#### 4.2 æ–¹æ³•äºŒï¼šä½¿ç”¨å‘½ä»¤è¡Œå¯¼å…¥
```bash
# åœ¨å®å¡”ç»ˆç«¯ä¸­æ‰§è¡Œ
cd /www/wwwroot/vue-manage-system
mysql -u author_center_user -p author_center < backend/sql/clean_database_with_admins.sql
```

#### 4.3 éªŒè¯å¯¼å…¥ç»“æœ
```sql
-- åœ¨å®å¡”æ•°æ®åº“ç®¡ç†ä¸­æ‰§è¡Œ
USE author_center;
SHOW TABLES;
SELECT COUNT(*) FROM managers WHERE status = 1;
```

### ç¬¬äº”æ­¥ï¼šé…ç½®åç«¯ç¯å¢ƒ

#### 5.1 åˆ›å»ºç¯å¢ƒé…ç½®æ–‡ä»¶
åœ¨ `/www/wwwroot/vue-manage-system/backend/server/.env`ï¼š
```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_USER=author_center_user
DB_PASS=ä½ çš„æ•°æ®åº“å¯†ç 
DB_NAME=author_center

# æœåŠ¡å™¨é…ç½®
PORT=3001
NODE_ENV=production

# JWTé…ç½®
JWT_SECRET=your-super-secret-jwt-key-here

# æ–‡ä»¶ä¸Šä¼ é…ç½®
UPLOAD_PATH=/www/wwwroot/vue-manage-system/uploads
```

#### 5.2 å®‰è£…åç«¯ä¾èµ–
```bash
# åœ¨å®å¡”ç»ˆç«¯ä¸­æ‰§è¡Œ
cd /www/wwwroot/vue-manage-system/backend/server
npm install --production
```

#### 5.3 å¯åŠ¨åç«¯æœåŠ¡
```bash
# ä½¿ç”¨PM2å¯åŠ¨
cd /www/wwwroot/vue-manage-system/backend/server
pm2 start npm --name "vue-manage-backend" -- run start
pm2 save
pm2 startup
```

### ç¬¬å…­æ­¥ï¼šé…ç½®å‰ç«¯ç¯å¢ƒ

#### 6.1 åˆ›å»ºå‰ç«¯ç¯å¢ƒé…ç½®
åœ¨ `/www/wwwroot/vue-manage-system/frontend/.env.production`ï¼š
```env
VITE_API_BASE_URL=https://ä½ çš„åŸŸå/api
VITE_UPLOAD_URL=https://ä½ çš„åŸŸå/uploads
```

#### 6.2 æ„å»ºå‰ç«¯é¡¹ç›®
```bash
# åœ¨å®å¡”ç»ˆç«¯ä¸­æ‰§è¡Œ
cd /www/wwwroot/vue-manage-system/frontend
npm install
npm run build
```

### ç¬¬ä¸ƒæ­¥ï¼šé…ç½®Nginx

#### 7.1 åœ¨å®å¡”é¢æ¿æ·»åŠ ç«™ç‚¹
1. è¿›å…¥ **ç½‘ç«™** â†’ **æ·»åŠ ç«™ç‚¹**
2. å¡«å†™åŸŸåä¿¡æ¯
3. æ ¹ç›®å½•è®¾ç½®ä¸ºï¼š`/www/wwwroot/vue-manage-system/frontend/dist`

#### 7.2 é…ç½®Nginxåå‘ä»£ç†
åœ¨å®å¡”é¢æ¿ â†’ ç½‘ç«™ â†’ è®¾ç½® â†’ é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```nginx
server {
    listen 80;
    server_name ä½ çš„åŸŸå;
    
    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /www/wwwroot/vue-manage-system/frontend/dist;
        try_files $uri $uri/ /index.html;
        index index.html;
    }
    
    # APIåå‘ä»£ç†
    location /api/ {
        proxy_pass http://127.0.0.1:3001/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # å¤„ç†è·¨åŸŸ
        add_header Access-Control-Allow-Origin *;
        add_header Access-Control-Allow-Methods 'GET, POST, PUT, DELETE, OPTIONS';
        add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization';
        
        if ($request_method = 'OPTIONS') {
            return 204;
        }
    }
    
    # æ–‡ä»¶ä¸Šä¼ ç›®å½•
    location /uploads/ {
        alias /www/wwwroot/vue-manage-system/uploads/;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }
    
    # å®‰å…¨é…ç½®
    location ~ /\. {
        deny all;
    }
    
    # æ—¥å¿—é…ç½®
    access_log /www/wwwlogs/vue-manage-system.log;
    error_log /www/wwwlogs/vue-manage-system.error.log;
}
```

#### 7.3 é…ç½®SSLè¯ä¹¦ï¼ˆæ¨èï¼‰
1. åœ¨å®å¡”é¢æ¿ â†’ ç½‘ç«™ â†’ SSL
2. é€‰æ‹© Let's Encrypt å…è´¹è¯ä¹¦
3. ç”³è¯·å¹¶éƒ¨ç½²è¯ä¹¦

### ç¬¬å…«æ­¥ï¼šé…ç½®é˜²ç«å¢™å’Œå®‰å…¨

#### 8.1 å®å¡”é¢æ¿å®‰å…¨é…ç½®
1. **é¢æ¿è®¾ç½®** â†’ ä¿®æ”¹é»˜è®¤ç«¯å£
2. **å®‰å…¨** â†’ é…ç½®SSHç«¯å£
3. **é˜²ç«å¢™** â†’ å¼€æ”¾å¿…è¦ç«¯å£ï¼š
   - 80 (HTTP)
   - 443 (HTTPS)
   - 3001 (åç«¯APIï¼Œä»…å†…ç½‘)

#### 8.2 æ•°æ®åº“å®‰å…¨é…ç½®
```sql
-- åˆ é™¤ä¸å¿…è¦çš„ç”¨æˆ·
DROP USER IF EXISTS ''@'localhost';
DROP USER IF EXISTS ''@'%';

-- ä¿®æ”¹rootå¯†ç 
ALTER USER 'root'@'localhost' IDENTIFIED BY 'å¼ºå¯†ç ';
FLUSH PRIVILEGES;
```

### ç¬¬ä¹æ­¥ï¼šç›‘æ§å’Œç»´æŠ¤

#### 9.1 é…ç½®PM2ç›‘æ§
```bash
# æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs vue-manage-backend

# é‡å¯æœåŠ¡
pm2 restart vue-manage-backend

# ç›‘æ§é¢æ¿
pm2 monit
```

#### 9.2 é…ç½®è‡ªåŠ¨å¤‡ä»½
åœ¨å®å¡”é¢æ¿ â†’ è®¡åˆ’ä»»åŠ¡ä¸­æ·»åŠ ï¼š
```bash
# æ¯æ—¥å‡Œæ™¨2ç‚¹å¤‡ä»½æ•°æ®åº“
0 2 * * * mysqldump -u author_center_user -på¯†ç  author_center > /www/backup/author_center_$(date +\%Y\%m\%d).sql

# æ¯å‘¨å¤‡ä»½é¡¹ç›®æ–‡ä»¶
0 3 * * 0 tar -czf /www/backup/vue-manage-system_$(date +\%Y\%m\%d).tar.gz /www/wwwroot/vue-manage-system
```

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1ï¼šNode.jsç‰ˆæœ¬ä¸å…¼å®¹
```bash
# ä½¿ç”¨nvmç®¡ç†Node.jsç‰ˆæœ¬
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
source ~/.bashrc
nvm install 18
nvm use 18
```

### é—®é¢˜2ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥
1. æ£€æŸ¥æ•°æ®åº“æœåŠ¡çŠ¶æ€
2. éªŒè¯ç”¨æˆ·åå¯†ç 
3. ç¡®è®¤é˜²ç«å¢™è®¾ç½®
4. æ£€æŸ¥MySQLé…ç½®æ–‡ä»¶

### é—®é¢˜3ï¼šæ–‡ä»¶ä¸Šä¼ æƒé™é—®é¢˜
```bash
# è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™
chown -R www:www /www/wwwroot/vue-manage-system/uploads
chmod -R 755 /www/wwwroot/vue-manage-system/uploads
```

### é—®é¢˜4ï¼šå‰ç«¯è·¯ç”±404é—®é¢˜
ç¡®ä¿Nginxé…ç½®ä¸­æœ‰ `try_files $uri $uri/ /index.html;`

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### æ•°æ®åº“ä¼˜åŒ–
```sql
-- æ·»åŠ ç´¢å¼•
ALTER TABLE orders ADD INDEX idx_created_at (created_at);
ALTER TABLE users ADD INDEX idx_status (status);

-- é…ç½®MySQLå‚æ•°
SET GLOBAL innodb_buffer_pool_size = 1073741824; -- 1GB
```

### Nginxä¼˜åŒ–
```nginx
# å¯ç”¨gzipå‹ç¼©
gzip on;
gzip_vary on;
gzip_min_length 1024;
gzip_types text/plain text/css application/json application/javascript text/xml application/xml;

# é™æ€æ–‡ä»¶ç¼“å­˜
location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}
```

## ğŸ¯ éƒ¨ç½²éªŒè¯æ¸…å•

éƒ¨ç½²å®Œæˆåï¼Œè¯·éªŒè¯ä»¥ä¸‹åŠŸèƒ½ï¼š

- [ ] ç½‘ç«™å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] ç®¡ç†å‘˜å¯ä»¥æ­£å¸¸ç™»å½•
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ­£å¸¸
- [ ] APIæ¥å£å“åº”æ­£å¸¸
- [ ] SSLè¯ä¹¦é…ç½®æ­£ç¡®
- [ ] PM2è¿›ç¨‹è¿è¡Œç¨³å®š
- [ ] æ—¥å¿—è®°å½•æ­£å¸¸

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### ç®¡ç†å‘˜è´¦æˆ·ä¿¡æ¯
| è´¦æˆ· | æ‰‹æœºå· | å¯†ç  |
|------|--------|------|
| è¶…çº§ç®¡ç†å‘˜1 | 13800000001 | admin123456 |
| è¶…çº§ç®¡ç†å‘˜2 | 13800000002 | admin123456 |
| è¶…çº§ç®¡ç†å‘˜3 | 13800000003 | admin123456 |
| è¶…çº§ç®¡ç†å‘˜4 | 13800000004 | admin123456 |

### é‡è¦æ–‡ä»¶è·¯å¾„
- **é¡¹ç›®æ ¹ç›®å½•**ï¼š`/www/wwwroot/vue-manage-system/`
- **åç«¯é…ç½®**ï¼š`/www/wwwroot/vue-manage-system/backend/server/.env`
- **å‰ç«¯æ„å»º**ï¼š`/www/wwwroot/vue-manage-system/frontend/dist/`
- **ä¸Šä¼ ç›®å½•**ï¼š`/www/wwwroot/vue-manage-system/uploads/`
- **æ•°æ®åº“å¤‡ä»½**ï¼š`/www/backup/`

### å¸¸ç”¨å‘½ä»¤
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
pm2 status

# é‡å¯åç«¯æœåŠ¡
pm2 restart vue-manage-backend

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
pm2 logs vue-manage-backend --lines 100

# é‡æ–°æ„å»ºå‰ç«¯
cd /www/wwwroot/vue-manage-system/frontend && npm run build

# é‡å¯Nginx
systemctl restart nginx

# æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€
systemctl status mysql
```

---

*æœ€åæ›´æ–°ï¼š2025å¹´1æœˆ*
*é€‚ç”¨äºå®å¡”é¢æ¿ 7.7.0+ ç‰ˆæœ¬*